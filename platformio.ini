; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

; ========================================
; Common Settings
; ========================================
[common]
platform = espressif32@^6.0.0
framework = arduino
monitor_speed = 115200
lib_extra_dirs = lib
lib_ignore = AsyncTCP
base_flags =
    -std=gnu++17
    -DARDUINO_ARCH_ESP32
    -DCONFIG_FREERTOS_USE_STATIC_ALLOCATION=1
    -DCONFIG_FREERTOS_UNICORE=1
    -DCONFIG_FREERTOS_VTASKLIST_INCLUDE_COREID=0

; Partition tables for 4MB flash
; huge_app.csv: ~3MB app (no OTA) - best for development
; min_spiffs.csv: ~1.9MB app + 190KB SPIFFS
[partition]
table_huge = huge_app.csv
table_min_spiffs = min_spiffs.csv

; ========================================
; Full Gateway (All Protocols)
; ========================================
[env:esp32_full]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
board_build.partitions = ${partition.table_huge}
build_flags =
    ${common.base_flags}
    -DUSE_MESH
    -DUSE_ZIGBEE
    -DUSE_BLE
    -DUSE_RF433
    -DUSE_WIFI_DEVICES
    -DUSE_MQTT
    -DUSE_WEB
    -DUSE_OTA
lib_deps =
    knolleary/PubSubClient
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome
    painlessMesh/painlessMesh
    sui77/rc-switch@^2.6.4

; ========================================
; Zigbee Gateway (Zigbee2MQTT)
; ========================================
[env:esp32_zigbee]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
build_flags =
    ${common.base_flags}
    -DUSE_ZIGBEE
    -DUSE_MQTT
    -DUSE_WEB
    -DUSE_OTA
lib_deps =
    knolleary/PubSubClient
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome

; ========================================
; BLE + RF433 Hub
; ========================================
[env:esp32_ble_rf]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
build_flags =
    ${common.base_flags}
    -DUSE_BLE
    -DUSE_RF433
    -DUSE_WEB
lib_deps =
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome
    sui77/rc-switch@^2.6.4

; ========================================
; Mesh Network Hub
; ========================================
[env:esp32_mesh]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
build_flags =
    ${common.base_flags}
    -DUSE_MESH
    -DUSE_WEB
lib_deps =
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome
    painlessMesh/painlessMesh

; ========================================
; WiFi Smart Devices Hub
; ========================================
[env:esp32_wifi]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
build_flags =
    ${common.base_flags}
    -DUSE_WIFI_DEVICES
    -DUSE_MQTT
    -DUSE_WEB
lib_deps =
    knolleary/PubSubClient
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome

; ========================================
; Minimal PLC (No protocols)
; ========================================
[env:esp32_minimal]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
build_flags =
    ${common.base_flags}
    -DUSE_WEB
lib_deps =
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome

; ========================================
; Development (Default - Full build)
; ========================================
[env:esp32dev]
platform = ${common.platform}
board = esp32dev
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
board_build.partitions = ${partition.table_huge}
build_flags =
    ${common.base_flags}
    -DUSE_MESH
    -DUSE_ZIGBEE
    -DUSE_BLE
    -DUSE_RF433
    -DUSE_WIFI_DEVICES
    -DUSE_MQTT
    -DUSE_WEB
    -DUSE_OTA
lib_deps =
    knolleary/PubSubClient
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome
    painlessMesh/painlessMesh
    sui77/rc-switch@^2.6.4

; ========================================
; ESP32-C6 Full Gateway (4MB Flash)
; ========================================
[env:esp32c6_full]
platform = ${common.platform}
board = esp32-c6-devkitc-1
framework = ${common.framework}
monitor_speed = ${common.monitor_speed}
lib_extra_dirs = ${common.lib_extra_dirs}
lib_ignore = ${common.lib_ignore}
board_build.partitions = ${partition.table_huge}
build_flags =
    ${common.base_flags}
    -DUSE_MESH
    -DUSE_ZIGBEE
    -DUSE_BLE
    -DUSE_RF433
    -DUSE_WIFI_DEVICES
    -DUSE_MQTT
    -DUSE_WEB
    -DUSE_OTA
    -DCONFIG_ESP32C6_DEFAULT
lib_deps =
    knolleary/PubSubClient
    bblanchon/ArduinoJson
    esphome/ESPAsyncWebServer-esphome
    esphome/AsyncTCP-esphome
    painlessMesh/painlessMesh
    sui77/rc-switch@^2.6.4
