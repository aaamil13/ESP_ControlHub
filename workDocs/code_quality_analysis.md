# EspHub - –ê–Ω–∞–ª–∏–∑ –Ω–∞ –ö–∞—á–µ—Å—Ç–≤–æ—Ç–æ –Ω–∞ –ö–æ–¥–∞

**–î–∞—Ç–∞:** 20 –ù–æ–µ–º–≤—Ä–∏ 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω –ø—Ä–æ–µ–∫—Ç:** EspHub - –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∏—Ä–∞–Ω PLC & IoT Hub –∑–∞ ESP32

---

## üìã –†–µ–∑—é–º–µ

EspHub –µ –∞–º–±–∏—Ü–∏–æ–∑–µ–Ω –∏ –¥–æ–±—Ä–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω –ø—Ä–æ–µ–∫—Ç –∑–∞ ESP32-–±–∞–∑–∏—Ä–∞–Ω–∞ IoT/PLC –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å –≤–ø–µ—á–∞—Ç–ª—è–≤–∞—â–∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ü—Ä–æ–µ–∫—Ç—ä—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–∞ —Å–∏–ª–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –º–æ–¥—É–ª–µ–Ω –¥–∏–∑–∞–π–Ω –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫—ä–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è—Ç–∞ –Ω–∞ –ø–∞–º–µ—Ç—Ç–∞. –¢–æ–∑–∏ –∞–Ω–∞–ª–∏–∑ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–∞ —Å–∏–ª–Ω–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞ –ø–æ–≤–∏—à–∞–≤–∞–Ω–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ—Ç–æ, –ø–æ–¥–¥—Ä—ä–∂–∫–∞—Ç–∞ –∏ –Ω–∞–¥–µ–∂–¥–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ –∫–æ–¥–∞.

### –û–±—â–∞ –û—Ü–µ–Ω–∫–∞: **7.5/10**

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–µ–Ω—Ç–∞—Ä |
|-----------|--------|----------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 8/10 | –û—Ç–ª–∏—á–Ω–∞ –º–æ–¥—É–ª–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ |
| –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –∫–æ–¥–∞ | 7/10 | –î–æ–±—Ä–æ, –Ω–æ –∏–º–∞ –º—è—Å—Ç–æ –∑–∞ –ø–æ–¥–æ–±—Ä–µ–Ω–∏–µ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 8/10 | –ú–Ω–æ–≥–æ –¥–æ–±—Ä–∞ –≤—ä–Ω—à–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| –¢–µ—Å—Ç–≤–∞–Ω–µ | 3/10 | –õ–∏–ø—Å–≤–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ —Ç–µ—Å—Ç–æ–≤–µ |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≥—Ä–µ—à–∫–∏ | 6/10 | –û—Å–Ω–æ–≤–Ω–æ –ª–æ–≥–≤–∞–Ω–µ, –ª–∏–ø—Å–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–∞–º–µ—Ç | 7/10 | –î–æ–±—Ä–æ, –Ω–æ –∏–º–∞ —Ä–∏—Å–∫–æ–≤–µ |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –∑–∞ –∫–æ–¥–∏—Ä–∞–Ω–µ | 7/10 | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ, –Ω–æ –Ω–µ –Ω–∞–≤—Å—è–∫—ä–¥–µ |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ–Ω –ê–Ω–∞–ª–∏–∑

### ‚úÖ –°–∏–ª–Ω–∏ –°—Ç—Ä–∞–Ω–∏

#### 1. –ú–æ–¥—É–ª–Ω–∞ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
lib/
‚îú‚îÄ‚îÄ Core/           # –Ø–¥—Ä–æ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ç–∞
‚îú‚îÄ‚îÄ PlcEngine/      # PLC —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç
‚îú‚îÄ‚îÄ Protocols/      # –ú—É–ª—Ç–∏–ø—Ä–æ—Ç–æ–∫–æ–ª–Ω–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞
‚îú‚îÄ‚îÄ Devices/        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ Export/         # MQTT/Mesh –µ–∫—Å–ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ Storage/        # –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –∏ OTA
‚îú‚îÄ‚îÄ UI/             # –£–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ Apps/           # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –≤–∏—Å–æ–∫–æ –Ω–∏–≤–æ
```

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
- –Ø—Å–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –æ—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏—Ç–µ (Separation of Concerns)
- –õ–µ—Å–Ω–∞ –ø–æ–¥–¥—Ä—ä–∂–∫–∞ –∏ —Ä–∞–∑—à–∏—Ä—è–µ–º–æ—Å—Ç
- –£—Å–ª–æ–≤–Ω–∞ –∫–æ–º–ø–∏–ª–∞—Ü–∏—è –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ (`USE_ZIGBEE`, `USE_RF433`)
- –î–æ–±—Ä–µ –æ—Ä–≥–∞–Ω–∏–∑–∏—Ä–∞–Ω–∞ –π–µ—Ä–∞—Ä—Ö–∏—è

#### 2. Zone Mesh Networking
- –ò–Ω–æ–≤–∞—Ç–∏–≤–µ–Ω –ø–æ–¥—Ö–æ–¥ –∑–∞ –º–∞—â–∞–±–∏—Ä—É–µ–º–æ—Å—Ç (400+ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ vs 50 –∑–∞ painlessMesh)
- –ò–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ç–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—Å–∫–∞ —Å–∏—Å—Ç–µ–º–∞
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –ø–∞–º–µ—Ç—Ç–∞ (~1-2KB –Ω–∞ –∑–æ–Ω–∞ vs 8KB)
- Beacon-–±–∞–∑–∏—Ä–∞–Ω–æ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏

#### 3. PLC Engine
- Parse-once, execute-many –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω I/O scan cycle (READ ‚Üí EXECUTE ‚Üí WRITE)
- Ownership —Å–∏—Å—Ç–µ–º–∞ –∑–∞ –∏–∑—Ö–æ–¥–∏

#### 4. Event-Driven System (IOEventManager)
- –ù–∞–º–∞–ª—è–≤–∞ CPU –Ω–∞—Ç–æ–≤–∞—Ä–≤–∞–Ω–µ—Ç–æ —Å 80% —Å–ø—Ä—è–º–æ polling
- –ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ I/O –∏ scheduled —Ç—Ä–∏–≥–µ—Ä–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—ä–±–∏—Ç–∏—è
- –ò—Å—Ç–æ—Ä–∏—è –Ω–∞ —Å—ä–±–∏—Ç–∏—è —Å MQTT –µ–∫—Å–ø–æ—Ä—Ç

### ‚ö†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∏ –ü—Ä–æ–±–ª–µ–º–∏

#### 1. –¢—è—Å–Ω–∞ –°–≤—ä—Ä–∑–∞–Ω–æ—Å—Ç (Tight Coupling)
**–ü—Ä–æ–±–ª–µ–º:** `EspHub.h` –≤–∫–ª—é—á–≤–∞ –≤—Å–∏—á–∫–∏ –º–µ–Ω–∏–¥–∂—ä—Ä–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ
```cpp
// EspHub.h - —Ç–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
#include "../Protocols/Mqtt/MqttManager.h"
#include "../PlcEngine/Engine/PlcEngine.h"
#include "../UI/WebManager.h"
// ... –æ—â–µ 10+ includes
```

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- –î—ä–ª–≥–æ –≤—Ä–µ–º–µ –∑–∞ –∫–æ–º–ø–∏–ª–∞—Ü–∏—è
- –¢—Ä—É–¥–Ω–∞ –∏–∑–æ–ª–∞—Ü–∏—è –∑–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ
- –ü—Ä–æ–º–µ–Ω–∏ –≤ –µ–¥–∏–Ω –º–æ–¥—É–ª –∑–∞—Å—è–≥–∞—Ç –º–Ω–æ–≥–æ —Ñ–∞–π–ª–æ–≤–µ

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Dependency Injection –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

#### 2. Singleton Pattern –ó–ª–æ—É–ø–æ—Ç—Ä–µ–±–∞
```cpp
// EspHub.cpp
EspHub* EspHub::instance = nullptr;
StreamLogger* EspHubLog = nullptr;
```

**–ü—Ä–æ–±–ª–µ–º–∏:**
- –ì–ª–æ–±–∞–ª–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –∑–∞—Ç—Ä—É–¥–Ω—è–≤–∞ —Ç–µ—Å—Ç–≤–∞–Ω–µ—Ç–æ
- –°–∫—Ä–∏—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –¢—Ä—É–¥–Ω–æ –∑–∞ unit testing

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Dependency Injection –≤–º–µ—Å—Ç–æ singleton

#### 3. –õ–∏–ø—Å–∞ –Ω–∞ –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∑–∞ –ü—Ä–æ—Ç–æ–∫–æ–ª–∏
**–ü—Ä–æ–±–ª–µ–º:** –í—Å–µ–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª –µ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å–≤—ä—Ä–∑–∞–Ω, –ª–∏–ø—Å–≤–∞ –æ–±—â –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –°—ä–∑–¥–∞–π—Ç–µ `ProtocolManagerInterface` –∏ –≥–æ –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ
```cpp
class ProtocolManagerInterface {
public:
    virtual bool begin() = 0;
    virtual void loop() = 0;
    virtual bool sendCommand(const String& endpoint, const String& value) = 0;
    virtual ~ProtocolManagerInterface() = default;
};
```

---

## üíª –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –ö–æ–¥–∞

### ‚úÖ –î–æ–±—Ä–∏ –ü—Ä–∞–∫—Ç–∏–∫–∏

#### 1. –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ Modern C++
```cpp
// PlcEngine.h - –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ std::unique_ptr
std::map<String, std::unique_ptr<PlcProgram>> programs;

// Polyfill –∑–∞ C++11
#if __cplusplus < 201402L
namespace std {
    template<typename T, typename... Args>
    unique_ptr<T> make_unique(Args&&... args) {
        return unique_ptr<T>(new T(std::forward<Args>(args)...));
    }
}
#endif
```

#### 2. –£—Å–ª–æ–≤–Ω–∞ –ö–æ–º–ø–∏–ª–∞—Ü–∏—è
```cpp
#ifdef USE_WIFI_DEVICES
    WiFiDeviceManager* wifiDeviceManager;
#endif

#ifdef USE_RF433
    RF433Manager* rf433Manager;
#endif
```

#### 3. –î–æ–±—Ä–∞ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –û—Ç–ª–∏—á–Ω–∏ README –∏ CONTRIBUTING —Ñ–∞–π–ª–æ–≤–µ
- –ü–æ–¥—Ä–æ–±–Ω–∏ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–∞ (ZoneMesh_Guide.md, IOEventManager_Guide.md)
- –ü—Ä–∏–º–µ—Ä–∏ –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ASCII –¥–∏–∞–≥—Ä–∞–º–∏ –∑–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∏ —Å –ö–∞—á–µ—Å—Ç–≤–æ—Ç–æ

#### 1. –¢–≤—ä—Ä–¥–µ –ú–Ω–æ–≥–æ TODO –ö–æ–º–µ–Ω—Ç–∞—Ä–∏ (17 –±—Ä–æ—è)

**–ö—Ä–∏—Ç–∏—á–Ω–∏ TODO-—Ç–∞:**
```cpp
// MeshDeviceManager.cpp:144
EspHubLog->println("TODO: Send subscription request to local coordinator");

// MeshDeviceManager.cpp:160-161
// TODO: Implement inter-zone subscription via coordinators
EspHubLog->println("TODO: Implement inter-zone subscription");

// ZoneManager.cpp:526
// TODO: Implement inter-zone routing via coordinators

// WebManager.cpp:100
// TODO: Add AsyncElegantOTA library for OTA updates

// MqttDiscoveryManager.cpp:18
// TODO: Implement MQTT Discovery
```

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- –ù–µ–∑–∞–≤—ä—Ä—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ runtime –≥—Ä–µ—à–∫–∏
- –û–±—ä—Ä–∫–≤–∞–Ω–µ –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
1. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–∞–π—Ç–µ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ç–µ TODO-—Ç–∞
2. –°—ä–∑–¥–∞–π—Ç–µ GitHub issues –∑–∞ –≤—Å—è–∫–æ TODO
3. –ò–ª–∏ –∑–∞–≤—ä—Ä—à–µ—Ç–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞, –∏–ª–∏ –ø—Ä–µ–º–∞—Ö–Ω–µ—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç—Ç–∞

#### 2. –õ–∏–ø—Å–∞ –Ω–∞ Error Handling

**–ü—Ä–æ–±–ª–µ–º:** –ü–æ–≤–µ—á–µ—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞–º–æ –ª–æ–≥–≤–∞—Ç –≥—Ä–µ—à–∫–∏, –±–µ–∑ –¥–∞ –≥–∏ –æ–±—Ä–∞–±–æ—Ç–≤–∞—Ç
```cpp
// main.cpp:33
DeserializationError error = deserializeJson(doc, message);
if (error) {
    EspHubLog->printf("deserializeJson() failed: %s\n", error.c_str());
    return; // –°–∞–º–æ –≤—Ä—ä—â–∞, –±–µ–∑ recovery
}
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –≥—Ä–µ—à–∫–∏
```cpp
enum class ErrorCode {
    SUCCESS,
    JSON_PARSE_ERROR,
    NETWORK_ERROR,
    MEMORY_ERROR,
    INVALID_CONFIG
};

class Result {
public:
    ErrorCode code;
    String message;
    bool isSuccess() const { return code == ErrorCode::SUCCESS; }
};
```

#### 3. –•–∞—Ä–¥–∫–æ–¥–∏—Ä–∞–Ω–∏ –°—Ç–æ–π–Ω–æ—Å—Ç–∏ –≤ main.cpp

**–ü—Ä–æ–±–ª–µ–º:**
```cpp
// main.cpp:5-11
const char* mqtt_server = "YOUR_MQTT_BROKER_IP";
const int mqtt_port = 1883;
char tz_info[64] = "EET-2EEST,M3.5.0/3,M10.5.0/4";
char mesh_password[64] = "your_mesh_password";
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–µ–Ω —Ñ–∞–π–ª (JSON –≤ LittleFS)
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ WiFiManager –∑–∞ –ø—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –°—ä—Ö—Ä–∞–Ω—è–≤–∞–π—Ç–µ –≤ NVS (Non-Volatile Storage)

#### 4. Unsafe Button Handling –≤ setup()

**–ü—Ä–æ–±–ª–µ–º:**
```cpp
// main.cpp:117-132
if (digitalRead(0) == LOW) {
    if (!buttonPressed) {
        buttonPressed = true;
        buttonPressStartTime = millis();
    }
    if (millis() - buttonPressStartTime > 5000) {
        hub.factoryReset();
    }
}
```

**–ü—Ä–æ–±–ª–µ–º–∏:**
- –ò–∑–ø—ä–ª–Ω—è–≤–∞ —Å–µ —Å–∞–º–æ –≤–µ–¥–Ω—ä–∂ –≤ `setup()`
- –ù—è–º–∞ debouncing
- –ë–ª–æ–∫–∏—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è—Ç–∞

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ü—Ä–µ–º–µ—Å—Ç–µ—Ç–µ –≤ `loop()` –∏–ª–∏ –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –ø—Ä–µ–∫—ä—Å–≤–∞–Ω–∏—è

#### 5. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ Memory Leaks

**–ü—Ä–æ–±–ª–µ–º:** –£—Å–ª–æ–≤–Ω–æ –∑–∞–¥–µ–ª–µ–Ω–∞ –ø–∞–º–µ—Ç –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–≤–∞–Ω–µ
```cpp
// EspHub.h:78-88
#ifdef USE_WIFI_DEVICES
    WiFiDeviceManager* wifiDeviceManager;
#endif

#ifdef USE_RF433
    RF433Manager* rf433Manager;
#endif
```

**–í—ä–ø—Ä–æ—Å:** –ö—ä–¥–µ —Å–µ –æ—Å–≤–æ–±–æ–∂–¥–∞–≤–∞ —Ç–∞–∑–∏ –ø–∞–º–µ—Ç?

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
```cpp
// –í –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –Ω–∞ EspHub
~EspHub() {
    #ifdef USE_WIFI_DEVICES
    if (wifiDeviceManager) delete wifiDeviceManager;
    #endif
    
    #ifdef USE_RF433
    if (rf433Manager) delete rf433Manager;
    #endif
}
```

#### 6. Unsafe String Operations

**–ü—Ä–æ–±–ª–µ–º:**
```cpp
// main.cpp:22-23
char* message = (char*)payload;
message[length] = '\0'; // –ó–∞–ø–∏—Å–≤–∞ –∏–∑–≤—ä–Ω –±—É—Ñ–µ—Ä–∞!
```

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ:** Buffer overflow, undefined behavior

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
```cpp
char message[length + 1];
memcpy(message, payload, length);
message[length] = '\0';
```

---

## üß™ –¢–µ—Å—Ç–≤–∞–Ω–µ

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ–Ω –ü—Ä–æ–±–ª–µ–º: –õ–∏–ø—Å–∞ –Ω–∞ –¢–µ—Å—Ç–æ–≤–µ

**–¢–µ–∫—É—â–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ:**
- –ù—è–º–∞ unit —Ç–µ—Å—Ç–æ–≤–µ
- –ù—è–º–∞ integration —Ç–µ—Å—Ç–æ–≤–µ
- –°–∞–º–æ –º–∞–Ω—É–∞–ª–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Ö–∞—Ä–¥—É–µ—Ä
- –ò–º–∞ `[env:esp32_test]` –≤ platformio.ini, –Ω–æ –Ω–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ:**
- –í–∏—Å–æ–∫–æ —Ä–∏—Å–∫ –æ—Ç —Ä–µ–≥—Ä–µ—Å–∏–∏
- –¢—Ä—É–¥–Ω–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–∞–Ω–µ
- –î—ä–ª–≥–æ –≤—Ä–µ–º–µ –∑–∞ debugging
- –ù–µ—Å–∏–≥—É—Ä–Ω–æ—Å—Ç –ø—Ä–∏ –ø—Ä–æ–º–µ–Ω–∏

### üìä –ü—Ä–µ–ø–æ—Ä—ä–∫–∏ –∑–∞ –¢–µ—Å—Ç–≤–∞–Ω–µ

#### 1. Unit Testing Framework
```cpp
// –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Unity –∑–∞ ESP32
#include <unity.h>

void test_zone_manager_initialization() {
    ZoneManager manager;
    manager.begin("test.device", "test_zone");
    TEST_ASSERT_EQUAL_STRING("test_zone", manager.getZoneName().c_str());
}

void test_plc_memory_allocation() {
    PlcMemory memory;
    memory.setBool("test_var", true);
    TEST_ASSERT_TRUE(memory.getBool("test_var"));
}

void setup() {
    UNITY_BEGIN();
    RUN_TEST(test_zone_manager_initialization);
    RUN_TEST(test_plc_memory_allocation);
    UNITY_END();
}
```

#### 2. Integration Tests
- –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ mesh –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—è –º–µ–∂–¥—É 2-3 —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ MQTT –ø—É–±–ª–∏–∫—É–≤–∞–Ω–µ/–ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ
- –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ PLC –ø—Ä–æ–≥—Ä–∞–º–∏ end-to-end

#### 3. Simulation Testing
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ QEMU –∑–∞ ESP32 —Å–∏–º—É–ª–∞—Ü–∏—è
- –ú–æ–∫–Ω–µ—Ç–µ —Ö–∞—Ä–¥—É–µ—Ä–Ω–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–π—Ç–µ —Å CI/CD

#### 4. Coverage Target
- **–ú–∏–Ω–∏–º—É–º:** 60% code coverage
- **–¶–µ–ª:** 80% –∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ (PlcEngine, ZoneManager)

---

## üîí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ì—Ä–µ—à–∫–∏ –∏ –°–∏–≥—É—Ä–Ω–æ—Å—Ç

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∏ —Å—ä—Å –°–∏–≥—É—Ä–Ω–æ—Å—Ç—Ç–∞

#### 1. Hardcoded Credentials
```cpp
// main.cpp
const char* ssid = "YOUR_WIFI_SSID";
const char* password = "YOUR_WIFI_PASSWORD";
char mesh_password[64] = "your_mesh_password";
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ WiFiManager –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ—Ä—Ç–∞–ª

#### 2. –õ–∏–ø—Å–∞ –Ω–∞ Input Validation
```cpp
// main.cpp:26-28
if (strcmp(topic, "esphub/config/plc") == 0) {
    hub.loadPlcConfiguration(message); // –ù—è–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è!
}
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –í–∞–ª–∏–¥–∏—Ä–∞–π—Ç–µ JSON —Å—Ö–µ–º–∞—Ç–∞ –ø—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞

#### 3. –õ–∏–ø—Å–∞ –Ω–∞ TLS Certificate Validation
```cpp
// MqttManager.cpp - TLS —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞, –Ω–æ –Ω—è–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ certificate pinning

#### 4. Buffer Overflow Risks
```cpp
// main.cpp:22-23
message[length] = '\0'; // Unsafe!
```

#### 5. Factory Reset –±–µ–∑ –ü–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ
```cpp
// main.cpp:122-124
if (millis() - buttonPressStartTime > 5000) {
    hub.factoryReset(); // –î–∏—Ä–µ–∫—Ç–Ω–æ –∏–∑—Ç—Ä–∏–≤–∞ –≤—Å–∏—á–∫–æ!
}
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –î–æ–±–∞–≤–µ—Ç–µ LED –∏–Ω–¥–∏–∫–∞—Ü–∏—è –∏–ª–∏ –∑–≤—É–∫–æ–≤ —Å–∏–≥–Ω–∞–ª

---

## üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ü–∞–º–µ—Ç

### ‚úÖ –î–æ–±—Ä–∏ –ü—Ä–∞–∫—Ç–∏–∫–∏

#### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ Zone Mesh
- 1-2KB –Ω–∞ –∑–æ–Ω–∞ (vs 8KB –∑–∞ painlessMesh)
- –õ–æ–∫–∞–ª–Ω–∏ subscription registries
- –ò–∑–±—è–≥–≤–∞–Ω–µ –Ω–∞ –≥–ª–æ–±–∞–ª–Ω–∏ DHT

#### 2. Parse-Once Architecture –≤ PLC
- –ü–∞—Ä—Å–≤–∞ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–¥–Ω—ä–∂
- –ò–∑–ø—ä–ª–Ω—è–≤–∞ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ –±–µ–∑ overhead

#### 3. –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ Smart Pointers
```cpp
std::map<String, std::unique_ptr<PlcProgram>> programs;
```

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∏ —Å –ü–∞–º–µ—Ç—Ç–∞

#### 1. String Fragmentation
**–ü—Ä–æ–±–ª–µ–º:** –ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ `String` –∫–ª–∞—Å–∞
```cpp
String getEventHistory(bool unreadOnly = true);
String programName = doc["program"].as<String>();
```

**–í—ä–∑–¥–µ–π—Å—Ç–≤–∏–µ:** Heap fragmentation –Ω–∞ ESP32

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ `const char*` –∫—ä–¥–µ—Ç–æ –µ –≤—ä–∑–º–æ–∂–Ω–æ
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—á–Ω–∏ –±—É—Ñ–µ—Ä–∏ –∑–∞ –º–∞–ª–∫–∏ —Å—Ç—Ä–∏–Ω–≥–æ–≤–µ
- –†–µ–∑–µ—Ä–≤–∏—Ä–∞–π—Ç–µ –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç: `str.reserve(256)`

#### 2. JSON Document Sizing
```cpp
// main.cpp:31
StaticJsonDocument<200> doc; // –¢–≤—ä—Ä–¥–µ –º–∞–ª–∫–æ?
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ `DynamicJsonDocument` —Å –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –≥—Ä–µ—à–∫–∏

#### 3. –õ–∏–ø—Å–∞ –Ω–∞ Memory Monitoring
**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –î–æ–±–∞–≤–µ—Ç–µ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ –ª–æ–≥–≤–∞–Ω–µ –Ω–∞ –ø–∞–º–µ—Ç—Ç–∞
```cpp
void logMemoryStats() {
    EspHubLog->printf("Free heap: %d bytes\n", ESP.getFreeHeap());
    EspHubLog->printf("Min free heap: %d bytes\n", ESP.getMinFreeHeap());
    EspHubLog->printf("Heap fragmentation: %d%%\n", ESP.getHeapFragmentation());
}
```

---

## üìù –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏ –∑–∞ –ö–æ–¥–∏—Ä–∞–Ω–µ

### ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–æ—Å—Ç

#### –î–æ–±—Ä–µ –°–ø–∞–∑–µ–Ω–∏ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏:
- **File naming:** CamelCase.h/cpp ‚úÖ
- **Class names:** CamelCase ‚úÖ
- **Method names:** camelCase ‚úÖ
- **Constants:** UPPER_CASE ‚úÖ
- **Enums:** CamelCase type, UPPER_CASE values ‚úÖ

### ‚ö†Ô∏è –ù–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

#### 1. –ö–æ–º–µ–Ω—Ç–∞—Ä–∏
**–ü—Ä–æ–±–ª–µ–º:** –°–º–µ—Å–µ–Ω–∏ —Å—Ç–∏–ª–æ–≤–µ
```cpp
// –ü–æ–Ω—è–∫–æ–≥–∞ Doxygen
/**
 * @brief Subscribe to endpoint
 * @param endpoint Full path
 */

// –ü–æ–Ω—è–∫–æ–≥–∞ —Å–∞–º–æ //
// TODO: Implement this
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Doxygen –Ω–∞–≤—Å—è–∫—ä–¥–µ –∑–∞ –ø—É–±–ª–∏—á–Ω–∏ API-—Ç–∞

#### 2. Include Guards vs #pragma once
**–ü—Ä–æ–±–ª–µ–º:** –°–º–µ—Å–µ–Ω–∏ —Å—Ç–∏–ª–æ–≤–µ
```cpp
// –ù—è–∫–æ–∏ —Ñ–∞–π–ª–æ–≤–µ
#ifndef PLC_ENGINE_H
#define PLC_ENGINE_H
// ...
#endif

// –î—Ä—É–≥–∏ —Ñ–∞–π–ª–æ–≤–µ –º–æ–≥–∞—Ç –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç #pragma once
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–∞–π—Ç–µ –Ω–∞ `#pragma once` (–ø–æ-–º–æ–¥–µ—Ä–Ω–æ)

#### 3. Naming –Ω–∞ Private Members
**–ü—Ä–æ–±–ª–µ–º:** –ù–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
```cpp
// –ü–æ–Ω—è–∫–æ–≥–∞ —Å underscore
ZoneRouter* _router;

// –ü–æ–Ω—è–∫–æ–≥–∞ –±–µ–∑
ZoneRouter* router;
```

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:** –ò–∑–±–µ—Ä–µ—Ç–µ –µ–¥–∏–Ω —Å—Ç–∏–ª (–ø—Ä–µ–ø–æ—Ä—ä—á–≤–∞–º —Å underscore)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### ‚úÖ –û—Ç–ª–∏—á–Ω–∞ –í—ä–Ω—à–Ω–∞ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–∏–ª–Ω–∏ —Å—Ç—Ä–∞–Ω–∏:**
- –ü–æ–¥—Ä–æ–±–µ–Ω README.md —Å –ø—Ä–∏–º–µ—Ä–∏
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–∞ (ZoneMesh_Guide.md, IOEventManager_Guide.md)
- CONTRIBUTING.md —Å —è—Å–Ω–∏ –Ω–∞—Å–æ–∫–∏
- ASCII –¥–∏–∞–≥—Ä–∞–º–∏ –∑–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ü—Ä–∏–º–µ—Ä–∏ –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ‚ö†Ô∏è –õ–∏–ø—Å–≤–∞—â–∞ –í—ä—Ç—Ä–µ—à–Ω–∞ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∏:**
- –õ–∏–ø—Å–≤–∞—Ç Doxygen –∫–æ–º–µ–Ω—Ç–∞—Ä–∏ –∑–∞ –º–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–∏
- –ù—è–º–∞ API reference –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –õ–∏–ø—Å–≤–∞—Ç –¥–∏–∞–≥—Ä–∞–º–∏ –Ω–∞ –∫–ª–∞—Å–æ–≤–µ—Ç–µ (UML)
- –ù—è–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ –≤—ä—Ç—Ä–µ—à–Ω–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏

**–ü—Ä–µ–ø–æ—Ä—ä–∫–∞:**
1. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ Doxygen –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
2. –°—ä–∑–¥–∞–π—Ç–µ UML –¥–∏–∞–≥—Ä–∞–º–∏ —Å PlantUML
3. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ mesh protocol –¥–µ—Ç–∞–π–ª–Ω–æ
4. –î–æ–±–∞–≤–µ—Ç–µ troubleshooting —Å–µ–∫—Ü–∏–∏

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–∞–Ω–∏ –ü—Ä–µ–ø–æ—Ä—ä–∫–∏

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∏ (–ù–∞–ø—Ä–∞–≤–µ—Ç–µ –í–µ–¥–Ω–∞–≥–∞)

#### 1. –ü–æ–ø—Ä–∞–≤–µ—Ç–µ Buffer Overflow –≤ main.cpp
```cpp
// –ü–†–ï–î–ò (UNSAFE):
char* message = (char*)payload;
message[length] = '\0';

// –°–õ–ï–î (SAFE):
char message[length + 1];
memcpy(message, payload, length);
message[length] = '\0';
```

#### 2. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞ EspHub
```cpp
~EspHub() {
    #ifdef USE_WIFI_DEVICES
    if (wifiDeviceManager) delete wifiDeviceManager;
    #endif
    
    #ifdef USE_RF433
    if (rf433Manager) delete rf433Manager;
    #endif
    
    #ifdef USE_ZIGBEE
    if (zigbeeManager) delete zigbeeManager;
    #endif
}
```

#### 3. –ü—Ä–µ–º–µ—Å—Ç–µ—Ç–µ Button Handling –æ—Ç setup() –≤ loop()
```cpp
void loop() {
    static unsigned long lastButtonCheck = 0;
    if (millis() - lastButtonCheck > 50) { // Debounce
        checkFactoryResetButton();
        lastButtonCheck = millis();
    }
    hub.loop();
}
```

#### 4. –î–æ–±–∞–≤–µ—Ç–µ Input Validation
```cpp
bool validatePlcConfig(const char* jsonConfig) {
    StaticJsonDocument<512> doc;
    DeserializationError error = deserializeJson(doc, jsonConfig);
    
    if (error) return false;
    if (!doc.containsKey("program_name")) return false;
    if (!doc.containsKey("logic")) return false;
    
    return true;
}
```

### üü° –í–∞–∂–Ω–∏ (–ù–∞–ø—Ä–∞–≤–µ—Ç–µ –°–∫–æ—Ä–æ)

#### 5. –°—ä–∑–¥–∞–π—Ç–µ Unit Tests
- –ó–∞–ø–æ—á–Ω–µ—Ç–µ —Å PlcMemory
- –î–æ–±–∞–≤–µ—Ç–µ —Ç–µ—Å—Ç–æ–≤–µ –∑–∞ ZoneManager
- –¢–µ—Å—Ç–≤–∞–π—Ç–µ DeviceRegistry

#### 6. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ Error Handling Strategy
```cpp
class ErrorHandler {
public:
    static void handle(ErrorCode code, const String& context);
    static void logError(const String& message);
    static void recoverFromError(ErrorCode code);
};
```

#### 7. –ó–∞–≤—ä—Ä—à–µ—Ç–µ TODO-—Ç–∞—Ç–∞
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: Inter-zone routing
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: MQTT Discovery
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: OTA updates

#### 8. –î–æ–±–∞–≤–µ—Ç–µ Memory Monitoring
```cpp
void loop() {
    static unsigned long lastMemCheck = 0;
    if (millis() - lastMemCheck > 60000) { // –í—Å—è–∫–∞ –º–∏–Ω—É—Ç–∞
        logMemoryStats();
        lastMemCheck = millis();
    }
}
```

### üü¢ –ñ–µ–ª–∞—Ç–µ–ª–Ω–∏ (–î—ä–ª–≥–æ—Å—Ä–æ—á–Ω–∏)

#### 9. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–∞–π—Ç–µ –∫—ä–º Dependency Injection
```cpp
class EspHub {
public:
    EspHub(
        PlcEngine* plcEngine,
        MqttManager* mqttManager,
        WebManager* webManager
    );
};
```

#### 10. –°—ä–∑–¥–∞–π—Ç–µ Protocol Interface
```cpp
class ProtocolManagerInterface {
public:
    virtual bool begin() = 0;
    virtual void loop() = 0;
    virtual bool sendCommand(const String& endpoint, const String& value) = 0;
    virtual ~ProtocolManagerInterface() = default;
};
```

#### 11. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ Doxygen –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```bash
# Doxyfile
PROJECT_NAME = "EspHub"
OUTPUT_DIRECTORY = docs/api
GENERATE_HTML = YES
GENERATE_LATEX = NO
```

#### 12. –î–æ–±–∞–≤–µ—Ç–µ CI/CD Pipeline
```yaml
# .github/workflows/build.yml
name: Build
on: [push, pull_request]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup PlatformIO
        run: pip install platformio
      - name: Build
        run: platformio run -e esp32_full
      - name: Test
        run: platformio test -e esp32_test
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –ü—Ä–æ–µ–∫—Ç–∞

### –†–∞–∑–º–µ—Ä –Ω–∞ –ö–æ–¥–∞
```
Total Files: ~166 (–≤ lib/)
Total Lines: ~15,000+ (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª–Ω–æ)
Languages: C++ (95%), JSON (3%), Markdown (2%)
```

### –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –ü–∞–º–µ—Ç (–æ—Ç README)
```
RAM:   59,952 / 327,680 bytes (18.3%)
Flash: 1,392,177 / 3,145,728 bytes (44.3%)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:
- Zone Mesh: ~2KB RAM, ~5KB Flash (–Ω–∞ –∑–æ–Ω–∞)
- PLC Engine: ~10KB RAM, ~50KB Flash
- IOEventManager: ~7KB RAM, ~5KB Flash
- Protocol Managers: ~5KB RAM, ~30KB Flash
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```
- ArduinoJson v7.x
- PubSubClient (MQTT)
- ESPAsyncWebServer
- AsyncTCP
- painlessMesh
- rc-switch
```

---

## üîÑ –ü–ª–∞–Ω –∑–∞ –ü–æ–¥–æ–±—Ä–µ–Ω–∏–µ

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω–∏ –ü–æ–ø—Ä–∞–≤–∫–∏ (1-2 —Å–µ–¥–º–∏—Ü–∏)
- [ ] –ü–æ–ø—Ä–∞–≤–µ—Ç–µ buffer overflow –≤ main.cpp
- [ ] –î–æ–±–∞–≤–µ—Ç–µ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑–∞ EspHub
- [ ] –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ input validation
- [ ] –ü—Ä–µ–º–µ—Å—Ç–µ—Ç–µ button handling –≤ loop()
- [ ] –î–æ–±–∞–≤–µ—Ç–µ memory monitoring

### –§–∞–∑–∞ 2: –ö–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –ö–æ–¥–∞ (2-4 —Å–µ–¥–º–∏—Ü–∏)
- [ ] –°—ä–∑–¥–∞–π—Ç–µ unit tests (60% coverage)
- [ ] –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ error handling strategy
- [ ] –ó–∞–≤—ä—Ä—à–µ—Ç–µ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ç–µ TODO-—Ç–∞
- [ ] –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–∞–π—Ç–µ coding style
- [ ] –î–æ–±–∞–≤–µ—Ç–µ Doxygen –∫–æ–º–µ–Ω—Ç–∞—Ä–∏

### –§–∞–∑–∞ 3: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (1-2 –º–µ—Å–µ—Ü–∞)
- [ ] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–∞–π—Ç–µ –∫—ä–º DI
- [ ] –°—ä–∑–¥–∞–π—Ç–µ protocol interface
- [ ] –ù–∞–º–∞–ª–µ—Ç–µ coupling –≤ EspHub
- [ ] –î–æ–±–∞–≤–µ—Ç–µ integration tests
- [ ] –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ CI/CD

### –§–∞–∑–∞ 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (2-3 —Å–µ–¥–º–∏—Ü–∏)
- [ ] –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ API documentation
- [ ] –°—ä–∑–¥–∞–π—Ç–µ UML –¥–∏–∞–≥—Ä–∞–º–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ mesh protocol
- [ ] –î–æ–±–∞–≤–µ—Ç–µ troubleshooting guides
- [ ] –°—ä–∑–¥–∞–π—Ç–µ video tutorials

---

## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –°–∏–ª–Ω–∏ –°—Ç—Ä–∞–Ω–∏
1. **–û—Ç–ª–∏—á–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ú–æ–¥—É–ª–µ–Ω, —Ä–∞–∑—à–∏—Ä—è–µ–º –¥–∏–∑–∞–π–Ω
2. **–ò–Ω–æ–≤–∞—Ç–∏–≤–µ–Ω Zone Mesh** - –†–µ–∞–ª–Ω–æ —Ä–µ—à–µ–Ω–∏–µ –∑–∞ –º–∞—â–∞–±–∏—Ä—É–µ–º–æ—Å—Ç
3. **–ë–æ–≥–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç** - PLC, MQTT, Zigbee, RF433, BLE
4. **–î–æ–±—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ü–æ–¥—Ä–æ–±–Ω–∏ —Ä—ä–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–∏–º–µ—Ä–∏
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ –ø–∞–º–µ—Ç** - –í–Ω–∏–º–∞–Ω–∏–µ –∫—ä–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ç–∞ –Ω–∞ ESP32

### –û–±–ª–∞—Å—Ç–∏ –∑–∞ –ü–æ–¥–æ–±—Ä–µ–Ω–∏–µ
1. **–¢–µ—Å—Ç–≤–∞–Ω–µ** - –ö—Ä–∏—Ç–∏—á–Ω–∞ –ª–∏–ø—Å–∞ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–∏ —Ç–µ—Å—Ç–æ–≤–µ
2. **Error Handling** - –ù—É–∂–Ω–∞ –µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –≥—Ä–µ—à–∫–∏
3. **Code Quality** - –ú–Ω–æ–≥–æ TODO-—Ç–∞, –Ω—è–∫–æ–∏ unsafe –ø—Ä–∞–∫—Ç–∏–∫–∏
4. **Security** - Hardcoded credentials, –ª–∏–ø—Å–∞ –Ω–∞ validation
5. **Memory Safety** - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ leaks –∏ buffer overflows

### –ü—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–∏ –°–ª–µ–¥–≤–∞—â–∏ –°—Ç—ä–ø–∫–∏
1. –ó–∞–ø–æ—á–Ω–µ—Ç–µ —Å –∫—Ä–∏—Ç–∏—á–Ω–∏—Ç–µ –ø–æ–ø—Ä–∞–≤–∫–∏ (–§–∞–∑–∞ 1)
2. –°—ä–∑–¥–∞–π—Ç–µ unit tests –∑–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
3. –ó–∞–≤—ä—Ä—à–µ—Ç–µ –Ω–µ–∑–∞–≤—ä—Ä—à–µ–Ω–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç
4. –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–π—Ç–µ CI/CD –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–∞–Ω–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ
5. –ì–µ–Ω–µ—Ä–∏—Ä–∞–π—Ç–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û–±—â–∞ –ü—Ä–µ—Ü–µ–Ω–∫–∞
EspHub –µ **–º–Ω–æ–≥–æ –æ–±–µ—â–∞–≤–∞—â –ø—Ä–æ–µ–∫—Ç** —Å —Å–æ–ª–∏–¥–Ω–∞ –æ—Å–Ω–æ–≤–∞. –° —Ñ–æ–∫—É—Å –≤—ä—Ä—Ö—É —Ç–µ—Å—Ç–≤–∞–Ω–µ, error handling –∏ –∑–∞–≤—ä—Ä—à–≤–∞–Ω–µ –Ω–∞ –Ω–µ–∑–∞–≤—ä—Ä—à–µ–Ω–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç, —Ç–æ–π –º–æ–∂–µ –¥–∞ —Å—Ç–∞–Ω–µ **production-ready** –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞ –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª–Ω–∞ –∏ –¥–æ–º–∞—à–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è.

**–ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞–º:** –ü—Ä–æ–¥—ä–ª–∂–µ—Ç–µ —Ä–∞–∑–≤–∏—Ç–∏–µ—Ç–æ, –Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–∞–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ—Ç–æ –ø—Ä–µ–¥ –Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏.

---

**–ê–Ω–∞–ª–∏–∑ –∏–∑–≤—ä—Ä—à–µ–Ω –æ—Ç:** AI Code Reviewer  
**–î–∞—Ç–∞:** 20 –ù–æ–µ–º–≤—Ä–∏ 2025  
**–í–µ—Ä—Å–∏—è –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
